<!DOCTYPE HTML>
<html lang="de">
	<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
	
	body{
		background-color: #222222;
		font-family: -apple-system, 
			BlinkMacSystemFont, 
			"Segoe UI", 
			Roboto, 
			Oxygen-Sans, 
			Ubuntu, 
			Cantarell, 
			"Helvetica Neue", 
			sans-serif;
		color: black;
		/*background: linear-gradient(90deg, #ffa9a9, #64a1e0, #ffa9a9, #64a1e0);*/
		background: white;
		background-size: 400% 400%;
		/*-webkit-animation: gradientBG 14s ease infinite forwards;
		animation: gradientBG 14s ease infinite forwards;*/
		font-weight: lighter;
	}
	/** Animated background: Code By Webdevtrick ( https://webdevtrick.com ) **/
	@-webkit-keyframes gradientBG {
		0% {
			background-position: 0% 50%;
		}
		50% {
			background-position: 100% 50%;
		}
		100% {
			background-position: 0% 50%;
		}
	}
	
	@keyframes gradientBG {
		0% {
			background-position: 0% 50%;
		}
		50% {
			background-position: 100% 50%;
		}
		100% {
			background-position: 0% 50%;
		}
	}
	
	h1 {
	  font-weight: lighter;
	  letter-spacing: .125rem;
	  text-transform: uppercase;
	  color: black;
	  text-align: center;
	  font-size: x-large;
	}
	
	.buttonClass {
	  font-size:15px;
	  font-family:Arial;
	  width:70px;
	  height:70px;
	  color:#fff;
	  font-weight:200;
	  border-top-left-radius:14px;
	  border-top-right-radius:14px;
	  border-bottom-left-radius:14px;
	  border-bottom-right-radius:14px;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  -moz-user-select: none;
	  -webkit-user-select: none;
	  -ms-user-select:none;
	  user-select:none;
	  -o-user-select:none;
	}

	.buttonClass:hover {
	  opacity: 0.7;
	}
	
	.grid-container {
	  font-size:15px;
	  font-family:Arial;
	  display: grid;
	  grid-column-gap: 5px;
	  grid-row-gap: 5px;
	  grid-template-columns: auto auto auto auto;
	  padding: 10px;
	}

	.grid-item {
	  text-align: center;
	  display: inline-block;
	  text-align: center;
	}

	.dot {
		border-radius: 20%;
		display: flex;
		justify-content: center; /* align horizontal */
		align-items: center; /* align vertical */
		border: 1px solid lightgray;
	}

	.dot-mode {
		display: flex;
		justify-content: center; /* align horizontal */
		align-items: center; /* align vertical */
	}

	.active{
		/*border: 2px solid lightgray;*/
		background: black;
	}

	.mode-item{
		background: rgba(59, 57, 57, 0.308);
	}

	.mode-item:hover{
		opacity: 0.7;
	}

	.verticalline{
		border-bottom: 1px solid rgba(50, 50, 50, 0.356);
    	text-align: center;
    	color: gray;
	}

	input[type="checkbox"]{
		-webkit-appearance: none;
		-moz-appearance: none;
		appearance: none;
		-webkit-tap-highlight-color: transparent;
		cursor: pointer;
	}


	.toggle{
		height: 32px;
		width: 52px;
		border-radius: 16px;
		display: inline-block;
		position: relative;
		margin: 0;
		border: 2px solid #474755ab;
		background: linear-gradient(180deg, #7f84a0ab 0%, #63667cab 100%);
		transition: all .2s ease;
	}

	.toggle:after{
		content: '';
		position: absolute;
		top: 2px;
		left: 2px;
		width: 24px;
		height: 24px;
		border-radius: 50%;
		background: white;
		box-shadow: 0 1px 2px rgba(44,44,44,.2);
		transition: all .2s cubic-bezier(.5,.1,.75,1.35);
	}

	.toggle:checked{
		/*border-color: lightgray;*/
	}

	.toggle:checked::after{
		transform: translatex(20px);
		background: black;
	}

	label {
		text-align: right;
		clear: both;
		float:left;
		margin-right:15px;
		vertical-align: middle;
	}

	.checkbox-container{
		display:flex;
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin: 10px;
	}

	.headline{
		text-align: center;
		font-weight: 200;
		font-size: larger;
		margin-bottom: 5px;
	}

	.hidden{
		display: none;
	}

	.control-container{
		display: flex;
		flex-direction: row;
		justify-content: center;
	}

	.wide-button-bottom{
		width: 80%; 
		height: 40px; 
		margin: 10px; 
		padding: 5px;
		background-color: rgba(147, 147, 158, 0.4);
	}

	.arrow-button{
		width: 70px; 
		height: 70px;
		background-color: rgba(147, 147, 158, 0.4);
	}

	.tetris-button-bottom{
		width: 105px; 
		height: 40px; 
		margin: 5px;
		background-color: rgba(147, 147, 158, 0.4);
	}

	img{
		-moz-user-select: none;
		-webkit-user-select: none;	
		user-select: none;
	}

	.setting-button{
		position: absolute;
		padding: 10px;
	}

	.settings-container{
		height: 0px;
		transition: height 1s;
		overflow: hidden;
	}

	.show{
		height: 270px;
		transition: height 1s;
	}

	.number-container{
		display:flex;
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin: 10px;
	}

	.save-button{
		height: 30px; 
		margin: 5px; 
		background-color: black;
	}
  
	</style>
	<title>DIGITALCLOCK</title>
	<link rel="icon" type="image/svg" href="./icons/digitalclock.svg">
	</head>

	<body oncontextmenu="return false"> <!-- prevent opening of contextmenu --> 
		<div class="setting-button" onclick="toggleSettings()"><img src = "./icons/settings.svg" style="height:20px; filter: invert(100%);"/></div>
		
		<h1 id="headline">DIGITALCLOCK</h1>
		
		<div id="settings-container" class="settings-container">
			<div class="number-container">
				<label for="brightnessTime">Brightness Time:</label>
				<input type="range" id="brightnessTime" name="volume" min="10" max="255">
			</div>
			<div class="number-container">
				<label for="brightnessBackground">Brightness Background:</label>
				<input type="range" id="brightnessBackground" name="volume" min="10" max="255">
			</div>
			<div class="number-container">
				<label for="speedBackground">Background Speed:</label>
				<input type="range" id="speedBackground" name="volume" min="0.2" max="5" step="0.1">
			</div>
			<div class="number-container">
				<label for="nm_start" style="align-self: flex-start">Nightmode start time: </label> 
				<input type="time" id="nm_start" name="nm_start" min="00:00" max="23:59">
			</div>
			<div class="number-container">
				<label for="nm_end" style="align-self: flex-start">Nightmode end time: </label>
				<input type="time" id="nm_end" name="nm_end" min="00:00" max="23:59">
			</div>
			<div class="checkbox-container">
				<label for="reset_wifi" style="align-self: flex-start">Reset WiFi Settings</label> 
				<div>
					<input name= "reset_wifi" id="reset_wifi" type="checkbox" class="toggle">
				</div>
			</div>
			<div class="buttonClass save-button" onclick="saveSettings()">SAVE</div>
		</div>

		<div class="verticalline">
		</div>
		<div class="headline">
			MODE
		</div>
		<div class="checkbox-container">
			<label for="NightMode" style="align-self: flex-start">Nightmode</label> 
			<div>
				<span style="font-weight: 800; color: green;" id="NightMode">active</span>
			</div>
		</div>

		<div class="checkbox-container">
			<label for="LED_Off" style="align-self: flex-start">LEDs OFF</label> 
			<div>
				<input name= "LED_Off" id="LED_Off" type="checkbox" class="toggle">
			</div>
		</div>
		
		<div class="main-container" id="colorcontainer">
			<div class="verticalline">
			</div>
			<details>
				<summary class="headline">
					COLOR - TIME
				</summary>
				<div class="control-container">
					<div class="grid-container">
						<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-0-0')" class="buttonClass dot" style="background:rgb(128,0,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-0-0')" class="buttonClass dot" style="background:rgb(255,0,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-0-128')" class="buttonClass dot" style="background:rgb(0,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-0-128')" class="buttonClass dot" style="background:rgb(128,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-0-128')" class="buttonClass dot" style="background:rgb(255,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-0-255')" class="buttonClass dot" style="background:rgb(0,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-0-255')" class="buttonClass dot" style="background:rgb(128,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-0-255')" class="buttonClass dot" style="background:rgb(255,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-128-0')" class="buttonClass dot" style="background:rgb(0,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-128-0')" class="buttonClass dot" style="background:rgb(128,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-128-0')" class="buttonClass dot" style="background:rgb(255,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-128-128')" class="buttonClass dot" style="background:rgb(0,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-128-128')" class="buttonClass dot" style="background:rgb(128,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-128-128')" class="buttonClass dot" style="background:rgb(255,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-128-255')" class="buttonClass dot" style="background:rgb(0,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-128-255')" class="buttonClass dot" style="background:rgb(128,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-128-255')" class="buttonClass dot" style="background:rgb(255,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-255-0')" class="buttonClass dot" style="background:rgb(0,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-255-0')" class="buttonClass dot" style="background:rgb(128,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-255-0')" class="buttonClass dot" style="background:rgb(255,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=0-255-128')" class="buttonClass dot" style="background:rgb(0,255,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=128-255-128')" class="buttonClass dot" style="background:rgb(128,255,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-255-128')" class="buttonClass dot" style="background:rgb(255,255,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_time=255-255-255')" class="buttonClass dot" style="background:rgb(255,255,255);"></a></span></div>
					</div>
				</div>
			</details>
			
		</div>

		<div class="main-container" id="colorcontainer2">
			<div class="verticalline">
			</div>
			<details>
				<summary class="headline">
					COLOR - BACKGROUND
				</summary>
				<div class="control-container">
					<div class="grid-container">
						<div class="grid-container">
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-0-0')" class="buttonClass dot" style="background:rgb(128,0,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-0-0')" class="buttonClass dot" style="background:rgb(255,0,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-0-128')" class="buttonClass dot" style="background:rgb(0,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-0-128')" class="buttonClass dot" style="background:rgb(128,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-0-128')" class="buttonClass dot" style="background:rgb(255,0,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-0-255')" class="buttonClass dot" style="background:rgb(0,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-0-255')" class="buttonClass dot" style="background:rgb(128,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-0-255')" class="buttonClass dot" style="background:rgb(255,0,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-128-0')" class="buttonClass dot" style="background:rgb(0,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-128-0')" class="buttonClass dot" style="background:rgb(128,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-128-0')" class="buttonClass dot" style="background:rgb(255,128,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-128-128')" class="buttonClass dot" style="background:rgb(0,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-128-128')" class="buttonClass dot" style="background:rgb(128,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-128-128')" class="buttonClass dot" style="background:rgb(255,128,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-128-255')" class="buttonClass dot" style="background:rgb(0,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-128-255')" class="buttonClass dot" style="background:rgb(128,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-128-255')" class="buttonClass dot" style="background:rgb(255,128,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-255-0')" class="buttonClass dot" style="background:rgb(0,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-255-0')" class="buttonClass dot" style="background:rgb(128,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-255-0')" class="buttonClass dot" style="background:rgb(255,255,0);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-255-128')" class="buttonClass dot" style="background:rgb(0,255,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=128-255-128')" class="buttonClass dot" style="background:rgb(128,255,128);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=255-255-255')" class="buttonClass dot" style="background:rgb(255,255,255);"></a></span></div>
							<div class="grid-item"><span class="dot"><a onclick="sendCommand('./cmd?col_background=0-0-0')" class="buttonClass dot" style="background:rgb(0,0,0);"></a></span></div>
						  </div>
					</div>
				</div>
			</details>
			
		</div>

		
		

		<script>

			var xmlhttp = new XMLHttpRequest();
			var url = "./data?key=mode";
			var myVar = null;

			xmlhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					console.log(this.responseText);
					myVar = JSON.parse(this.responseText);

					// set checkbox states
					var span_nightMode = document.querySelector('span[id="NightMode"]');
					if(myVar.nightMode == "1") {
						console.log("nightMode == 1");
						span_nightMode.textContent = "active";
						span_nightMode.style.color = "green";
					}
					else {
						console.log("nightMode == 0");
						span_nightMode.textContent = "inactive";
						span_nightMode.style.color = "red";
					}

					// set checkbox states
					var ckb_ledoff = document.querySelector('input[id="LED_Off"]');
					if(myVar.ledoff == "1") {
						console.log("ledoff == 1");
						ckb_ledoff.checked = true;
					}
					else {
						console.log("ledoff == 0");
						ckb_ledoff.checked = false;
					}
					ckb_ledoff.addEventListener('change', () => {
						if(ckb_ledoff.checked) {
							sendCommand("./cmd?ledoff=1");
						} else {
							sendCommand("./cmd?ledoff=0");
						}
					});
					
					document.getElementById("nm_start").value = myVar.nightModeStart.replace("-", ":");
					document.getElementById("nm_end").value = myVar.nightModeEnd.replace("-", ":");
					document.getElementById("brightnessTime").value = parseInt(myVar.brightnessTime);
					document.getElementById("brightnessBackground").value = parseInt(myVar.brightnessBackground);
					document.getElementById("speedBackground").value = parseFloat(myVar.speedBackground);

					console.log(myVar);
				}
			};
			xmlhttp.open("GET", url, true);
			xmlhttp.send();

			function sendCommand(command){
				var xmlhttp = new XMLHttpRequest();
				xmlhttp.open("GET", command, true);
				xmlhttp.send();
			}

			function saveSettings(){
				var nmStart = document.getElementById("nm_start");
				var nmEnd = document.getElementById("nm_end");
				var sld_brightnessTime = document.getElementById("brightnessTime");
				var sld_brightnessBackground = document.getElementById("brightnessBackground");
				var sld_speedBackground = document.getElementById("speedBackground");
				var ckb_resetWifi = document.querySelector('input[id="reset_wifi"]');
				var cmdstr = "./cmd?setting=";
				cmdstr += nmStart.value.replace(":", "-");
				cmdstr += "-";
				cmdstr += nmEnd.value.replace(":", "-");
				cmdstr += "-";
				cmdstr += sld_brightnessTime.value;
				cmdstr += "-";
				cmdstr += sld_brightnessBackground.value;
				cmdstr += "-";
				cmdstr += sld_speedBackground.value;
				console.log(cmdstr);
				sendCommand(cmdstr);
				if(ckb_resetWifi.checked) {
					sendCommand("./cmd?resetwifi");
				}
				toggleSettings();
			}

			function toggleSettings(){
				var container = document.getElementById("settings-container");
				if(container.classList.contains("show")){
					container.classList.remove("show");
				}
				else {
					container.classList.add("show");
				}
			}
			
		</script>
	</body>

</html>